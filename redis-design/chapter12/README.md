# 事件

Redis服务器是一个事件驱动程序，服务器需要处理以下两类事件：
- 文件事件：服务器对套接字操作的抽象
- 时间事件：服务器对定时操作的抽象

## 一、文件事件

文件事件处理器：基于`Reactor`模式开发

- 使用I/O多路复用程序监听多个套接字，并根据套接字目前执行的任务来为套接字关联不同的事件处理器
- 当被监听的套接字准备好执行连接应答（accept）、读取（read）、写入（write）、关闭（close）等操作时，与操作相对应的文件
事件就会产生，这时文件事件处理器就会调用套接字之前关联好的事件处理器来处理这些事件

### 1.1 文件事件处理器的构成

![文件事件处理器的四个组成部分](./12-1.png)

### 1.2 IO多路复用程序的实现

### 1.3 事件的类型

IO多路复用程序可以监听多个套接字的`ae.h/AE_READABLE`事件和`ae.h/AE_WRITEABLE`事件：
- 当套接字变的可读时，或者有新的应答时，套接字产生`AE_READABLE`事件
- 当套接字变得可写时，套接字产生`AE_WRITEABLE`事件

当同时产生`AE_READABLE`和`AE_WRITEABLE`事件时，先处理`AE_READABLE`再处理`AE_WRITEABLE`。

### 1.4 API

### 1.5 文件事件的处理器

文件事件处理器分为：
- 连接应答处理器：对连接服务器的各个客户端进行应答
- 命令请求处理器：接收客户端传来的命令请求
- 命令回复处理器：返回命令的执行结果
- 复制处理器：主从服务器进行复制操作时，主从服务器都需要关联复制处理器

## 二、时间事件


