微服务架构中，我们将系统拆分成了很多的服务单元，各单元的应用间通过服务注册和订阅的方式互相依赖。由于每个单元在不同的进程中运行，依赖通过远程调用的方式执行，这样就有可能因为网络原因或是依赖服务自身问题出现调用故障或延迟，而这些问题会直接导致调用方的对外服务也出现延迟，若此时调用方的请求不断增加，最后就会因为等待出现故障的依赖方响应形成任务积压，最终导致自身服务的瘫痪。

在微服务架构中，存在着那么多的服务单元，若一个单元出现故障，就很容易因为依赖关系而引发故障的蔓延，最终导致整个系统的瘫痪，这样的架构相较于传统架构更加不稳定。为了解决这样的问题，产生了断路器等一系列服务保护机制。

断路器模式源于Martin Fowler的Ciruit Breaker一文。

分布式架构中，当某个服务单元发生故障，通过断路器的故障监控，向调用方返回一个错误响应，而不是长时间的等待，这样就不会使得线程因调用故障服务被长时间占用不释放，避免了故障在分布式系统中的蔓延。

Spring Cloud Hystrix 的目标，在于通过控制那些访问远程系统、服务和第三方库的节点，从而对延迟和故障提供更强大的容错能力。Hystrix具备服务降级、服务熔断、线程和信号隔离、请求缓存、请求合并以及服务监控等强大能力。

##快速入门

+ 消费端pom.xml引入依赖
    <dependency>
        <groupId>org.springframework.cloud</groupId>
        <artifactId>spring-cloud-starter-netflix-hystrix</artifactId>
    </dependency>
    
+ 在消费端主类中使用`@EnableCircuitBreaker`注解
+ 在调用服务的函数上增加`@HystrixCommand`注解，注解中设置`fallbackMethod`属性值，指定服务不可用时调用的方法

##原理分析

###工作流程

###断路器原理

###依赖隔离

##使用详解

###创建请求命令

###定义服务降级

###异常处理

###命令名称、分组以及线程池划分

###请求缓存

###请求合并

##属性详解

###Command属性

###collapser属性

###threadPool属性

##Hystrix仪表盘

###Turbine集群监控

###构建监控聚合服务

###与消息代理结合

